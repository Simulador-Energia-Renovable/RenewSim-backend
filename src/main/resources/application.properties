spring:
  profiles:
    active: dev  # por defecto en local

# =============================
# JWT CONFIG (common)
# =============================
security:
  jwt:
    issuer: renewsim-auth
    audience: renewsim-app
    secretBase64: ${JWT_SECRET_BASE64:}   # recomendado en entornos reales
    secret: ${JWT_SECRET_PLAINTEXT:}      # alternativa local/testing (>=32B)
    expiration-seconds: 3600
    not-before-skew-seconds: 0
    allowed-clock-skew-seconds: 60

  # =============================
  # RATE LIMITING (Brute-force guard)
  # =============================
  rate-limiting:
    enabled: true
    strategy: IP_USER         # IP | IP_USER
    max-attempts: 5
    window-seconds: 60
    retry-after-seconds: 60
    login-path: /api/v1/auth/login

# =============================
# AUTH SCOPES (YamlScopePolicy)
# =============================
auth:
  roleScopes:
    USER:
      - read:simulations
      - write:simulations
      - compare:simulations
    ADMIN:
      - read:simulations
      - write:simulations
      - compare:simulations
      - export:simulations
      - delete:simulations
      - read:users
      - manage:users

# =============================
# CORS CONFIG (centralized)
# =============================
cors:
  enabled: true
  allowed-origins:
    - https://renewsim.example.com
  allowed-methods: [ "GET", "POST", "PUT", "DELETE", "PATCH", "OPTIONS" ]
  allowed-headers: [ "Content-Type", "Authorization", "X-Requested-With", "X-Correlation-Id" ]
  exposed-headers: [ "X-Correlation-Id" ]
  allow-credentials: true
  max-age-seconds: 3600

# =============================
# LOGGING
# =============================
logging:
  level:
    org.springframework.security: INFO
    AUTH_AUDIT: WARN          # nuestro logger de auditoría
  pattern:
    # Añade correlationId desde MDC (visible en consola si no usas JSON)
    level: "%5p [corr=%X{correlationId}]"

# =============================
# ACTUATOR
# =============================
management:
  endpoints:
    web:
      exposure:
        include: health,info







